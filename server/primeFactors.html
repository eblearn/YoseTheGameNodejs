<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<title>Prime factors</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />

		<script type="text/javascript"> 
			function Number(aNumber) {
				this.number = aNumber;
					
				if (isAValidNumber(aNumber)) {
					this.decomposition = decomposeNumberWithPrimeFactors(aNumber);
				} else {
					this.error = getErrorType(aNumber);
				}
			}

			function decomposeNumberWithPrimeFactors(numberToDecompose) {
				
				var decomposition = [];
				var factor = 2;
					
				while (factor <= numberToDecompose) {
					while (numberToDecompose % factor == 0) {
						decomposition.push(factor);
						numberToDecompose = numberToDecompose / factor;
					}
					factor++;
				}
					
				return decomposition;
				
			}

			function isAValidNumber(checkNumber) {
				return isANumber(checkNumber) && !isABigNumber(checkNumber) && isAValidInteger(checkNumber);
			}

			function isANumber(checkNumber) {
				return !isNaN(parseFloat(checkNumber)) && isFinite(checkNumber);
			}

			function isABigNumber(checkNumber) {
				return checkNumber > 1000000;
			}
			
			function isAValidInteger(checkNumber) {
				return checkNumber > 1;
			}

			function  getErrorType(invalidNumber) {
				var errorType = "";
				
				if (!isANumber(invalidNumber)) {
					errorType = "not a number";
				} else if (isABigNumber(invalidNumber)) {
					errorType = "too big number (>1e6)";
				} else if (!isAValidInteger(invalidNumber)) {
					errorType = "not an integer > 1";
				}
				
				return errorType;
			}
							
			function showDecomposition() {
				var numbers = document.getElementById("number").value;
				var numbersToDecompose = [].concat(numbers.split(","));
				var result = "";
				var myDiv = document.getElementById("result");
				var myOrderedList = document.getElementById("results");
				
				for (var iNumber = 0; iNumber < numbersToDecompose.length; iNumber++) {
					
					var numberToDecompose = new Number(numbersToDecompose[iNumber]);
					var primeFactors = "";
					var resultNumberDecomposition = "";
					
					if (numberToDecompose.error === undefined) {
						primeFactors += numberToDecompose.decomposition[0].toString();
										
						for (var iFactor = 1; iFactor < numberToDecompose.decomposition.length; iFactor++) {
							primeFactors += " x " + numberToDecompose.decomposition[iFactor].toString();
						}

						resultNumberDecomposition = numberToDecompose.number + " = " +  primeFactors;
					} else if (numberToDecompose.error == "not a number") {
						resultNumberDecomposition = numberToDecompose.number + " is " + numberToDecompose.error;
					} else if (numberToDecompose.error == "not an integer > 1") {
						resultNumberDecomposition = numberToDecompose.number + " is " + numberToDecompose.error;
					} else {
						resultNumberDecomposition = numberToDecompose.error;
					}
					
					if (numbersToDecompose.length > 1) {
						var item = document.createElement('li');
						item.innerHTML = resultNumberDecomposition;
						myOrderedList.appendChild(item);
					} else {
						myDiv.innerHTML = resultNumberDecomposition;
					}
				}
			}
			
		</script> 
	</head>
	<body>
		<div id="title">
			Facteurs premiers
			<div id="invitation">
				Veuillez saisir le nombre que vous voulez décomposer en facteurs premiers ...
			</div>
			<input type="text" id="number">
			<button type="button" id="go" onclick="showDecomposition();">Décomposer ...</button>
			<div id="result"></div>
			<ol id="results"></ol>
		</div>		
   </body>
</html>